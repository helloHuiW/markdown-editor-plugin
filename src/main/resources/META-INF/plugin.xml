<idea-plugin>
    <id>com.markdown.editor.plugin</id>
    <name>mini-markdown</name>

    <vendor email="327398329@qq.com">wanghui</vendor>

    <description>
    A comprehensive markdown editor with preview functionality
    <![CDATA[
    <h3>Markdown Editor - 强大的Markdown编辑和预览插件</h3>
    <p>这是一个功能丰富的Markdown编辑器插件，为IntelliJ IDEA提供了完整的文本编辑和Markdown处理功能。</p>
    
    <p><em>集成在工具窗口中的编辑器，支持语法高亮、行号显示和实时编辑功能</em></p>
    
    <p><em>实时预览功能，支持多种主题切换和即时渲染</em></p>
    
    <h4>✨ 主要特性：</h4>
    <ul>
        <li>🔤 <strong>高级文本编辑器</strong> - 支持语法高亮、代码折叠、智能补全</li>
        <li>📝 <strong>Markdown编辑</strong> - 完整的Markdown语法支持</li>
        <li>👁️ <strong>实时预览</strong> - 所见即所得的预览功能，支持代码块折叠</li>
        <li>📁 <strong>文件操作</strong> - 新建、打开、保存、另存为功能</li>
        <li>🔄 <strong>Tab切换</strong> - 编辑和预览之间轻松切换</li>
        <li>🛠️ <strong>工具栏集成</strong> - 所有功能一键可达</li>
        <li>⚡ <strong>一体化体验</strong> - 直接集成在工具窗口中，无需弹窗</li>
    </ul>
    
    <h4>🚀 使用方法：</h4>
    <ol>
        <li>在右侧工具窗口找到 <strong>"MarkDown"</strong></li>
        <li>在 <strong>"📝 编辑"</strong> Tab中编写Markdown内容</li>
        <li>在 <strong>"👁️ 预览"</strong> Tab中查看实时效果</li>
        <li>使用工具栏进行文件操作和主题切换</li>
    </ol>
    
    <h4>🔗 项目地址：</h4>
    <p><a href="https://github.com/helloHuiW/markdown-editor-plugin">GitHub 仓库</a> - 欢迎 Star 和贡献代码</p>
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>
    <depends>org.intellij.plugins.markdown</depends>

    <idea-version since-build="233" until-build="251.*"/>

    <extensions defaultExtensionNs="com.intellij">
        <!-- 文件类型定义 -->
        <fileType name="Markdown Editor File" 
                  implementationClass="com.markdown.editor.file.MarkdownFileType"
                  fieldName="INSTANCE" 
                  language="Markdown"
                  extensions="md;markdown;mdown;mkd"/>

        <!-- 编辑器组件 -->
        <fileEditorProvider implementation="com.markdown.editor.editor.MarkdownFileEditorProvider"/>
        
        <!-- 语言支持 - 移除自定义语法高亮，使用内置Markdown插件 -->
        
        <!-- 代码折叠 -->
        <lang.foldingBuilder language="Markdown" 
                             implementationClass="com.markdown.editor.folding.MarkdownFoldingBuilder"/>
        
        <!-- 工具窗口 -->
        <toolWindow id="MarkDown" 
                    secondary="true" 
                    anchor="right" 
                    factoryClass="com.markdown.editor.toolwindow.MarkdownToolWindowFactory"/>
        
        <!-- 行标记提供者 -->
        <codeInsight.lineMarkerProvider language="Markdown" 
                                       implementationClass="com.markdown.editor.markers.MarkdownLineMarkerProvider"/>
    </extensions>

    <actions>
        <!-- 主菜单 -->
        <group id="MarkdownEditor.TopLevelMenu" text="Markdown Editor" description="Markdown Editor actions">
            <add-to-group group-id="MainMenu" anchor="before" relative-to-action="HelpMenu"/>
        
            <action id="MarkdownEditor.TogglePreview"
                    class="com.markdown.editor.actions.TogglePreviewAction"
                    text="切换预览"
                    description="切换Markdown预览显示">
                <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift P"/>
            </action>
            
        </group>
        
        
        <!-- 编辑器上下文菜单 -->
        <group id="MarkdownEditor.EditorPopupMenu">
            <reference ref="MarkdownEditor.TogglePreview"/>
            <separator/>
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </group>
    </actions>
</idea-plugin>
